
---

# ğŸ§©ã€è¿½åŠ ã€‘å®Ÿè£…ã‚µãƒ³ãƒ—ãƒ«é›†ï¼ˆreserve-web å°‚ç”¨ï¼‰

> ä»¥ä¸‹ã®ã‚³ãƒ¼ãƒ‰ã¯ã€**è¨­è¨ˆæ›¸æå‡ºå¾Œã€ã™ãã«é–‹ç™ºã«ç§»ã‚Œã‚‹ã‚ˆã†**ã€  
> æœ€ä½é™ã®å‹•ä½œã‚’ä¿è¨¼ã™ã‚‹ã€Œé››å½¢ã€ã§ã™ã€‚  
> GitHubãƒªãƒã‚¸ãƒˆãƒªã® `docs/` ãƒ•ã‚©ãƒ«ãƒ€ã«ä¿å­˜æ¨å¥¨ã€‚

---

## âœ… 1. TypeScriptã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆé››å½¢ï¼ˆæ–½è¨­ä¸€è¦§è¡¨ç¤ºï¼‰

**ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹**: `app/(user)/facilities/page.tsx`

```tsx
'use client';

import { useEffect, useState } from 'react';
import type { Facility } from '@/types/facility';

// å‹å®šç¾©ï¼ˆtypes/facility.ts ã«ä¿å­˜æ¨å¥¨ï¼‰
export interface Facility {
  id: number;
  name: string;
  description: string;
  capacity: number;
  is_active: boolean;
}

export default function FacilityListPage() {
  const [facilities, setFacilities] = useState<Facility[]>([]);
  const [loading, setLoading] = useState(true);

  useEffect(() => {
    const fetchFacilities = async () => {
      try {
        const res = await fetch('/api/get-facilities.php');
        const result = await res.json();

        if (result.success) {
          setFacilities(result.data);
        } else {
          alert('æ–½è¨­æƒ…å ±ã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸ');
        }
      } catch (error) {
        alert('é€šä¿¡ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ');
      } finally {
        setLoading(false);
      }
    };

    fetchFacilities();
  }, []);

  if (loading) return <div>èª­ã¿è¾¼ã¿ä¸­...</div>;

  return (
    <div className="p-6">
      <h1 className="text-2xl font-bold mb-6">æ–½è¨­ä¸€è¦§</h1>
      <div className="grid gap-4 md:grid-cols-2 lg:grid-cols-3">
        {facilities.map((facility) => (
          <div
            key={facility.id}
            className="p-4 border rounded-lg shadow hover:shadow-md transition"
          >
            <h2 className="text-xl font-semibold">{facility.name}</h2>
            <p className="text-gray-600 mt-2">{facility.description}</p>
            <p className="mt-2">
              åå®¹äººæ•°: <strong>{facility.capacity}å</strong>
            </p>
            <p className="mt-1">
              çŠ¶æ…‹: <span className={facility.is_active ? 'text-green-600' : 'text-red-600'}>
                {facility.is_active ? 'äºˆç´„å¯èƒ½' : 'åˆ©ç”¨ä¸å¯'}
              </span>
            </p>
          </div>
        ))}
      </div>
    </div>
  );
}
```

---

## âœ… 2. PHP APIæ¥ç¶šã‚µãƒ³ãƒ—ãƒ«ï¼ˆæ–½è¨­ä¸€è¦§å–å¾—ï¼‰

**ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹**: `api/get-facilities.php`  
â€» ãƒ‡ãƒ—ãƒ­ã‚¤æ™‚ã¯Xserverã® `public_html/api/` ã«é…ç½®

```php
<?php
// api/get-facilities.php
header('Content-Type: application/json; charset=utf-8');

// CORSå¯¾å¿œï¼ˆé–‹ç™ºæ™‚ã®ã¿ã€‚æœ¬ç•ªã¯å¿…è¦ã«å¿œã˜ã¦åˆ¶é™ï¼‰
header("Access-Control-Allow-Origin: *");
header("Access-Control-Allow-Methods: GET, POST");
header("Access-Control-Allow-Headers: Content-Type");

try {
    // ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šï¼ˆåˆ¥ãƒ•ã‚¡ã‚¤ãƒ«ã§å®šç¾©æ¨å¥¨ â†’ æ¬¡é …å‚ç…§ï¼‰
    require_once __DIR__ . '/../lib/db.php';

    // æ–½è¨­ä¸€è¦§å–å¾—ï¼ˆæœ‰åŠ¹ãªæ–½è¨­ã®ã¿ï¼‰
    $stmt = $pdo->prepare("
        SELECT id, name, description, capacity, is_active
        FROM facilities
        WHERE is_active = true
        ORDER BY name ASC
    ");
    $stmt->execute();
    $facilities = $stmt->fetchAll(PDO::FETCH_ASSOC);

    // æˆåŠŸãƒ¬ã‚¹ãƒãƒ³ã‚¹
    echo json_encode([
        'success' => true,
        'data' => $facilities,
        'message' => ''
    ]);

} catch (Exception $e) {
    // ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°ï¼ˆæœ¬ç•ªã¯ãƒ•ã‚¡ã‚¤ãƒ«å‡ºåŠ›æ¨å¥¨ï¼‰
    error_log('æ–½è¨­å–å¾—ã‚¨ãƒ©ãƒ¼: ' . $e->getMessage());

    // ãƒ¦ãƒ¼ã‚¶ãƒ¼å‘ã‘ã«ã¯è©³ç´°éè¡¨ç¤º
    echo json_encode([
        'success' => false,
        'data' => null,
        'message' => 'æ–½è¨­æƒ…å ±ã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸ'
    ]);
}
```

---

## âœ… 3. PDOæ¥ç¶šè¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ä¾‹ï¼ˆMySQLæ¥ç¶šï¼‰

**ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹**: `lib/db.php`  
â€» `api/` é…ä¸‹ã®PHPãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰ `require_once` ã§èª­ã¿è¾¼ã‚€

```php
<?php
// lib/db.php

// è¨­å®šå€¤ï¼ˆç’°å¢ƒå¤‰æ•° or å®šæ•°ã€‚æœ¬ç•ªã¯ .env.php ã‚’åˆ¥é€”ä½œæˆæ¨å¥¨ï¼‰
define('DB_HOST', 'localhost');      // Xserverã®MySQLãƒ›ã‚¹ãƒˆåï¼ˆé€šå¸¸ localhostï¼‰
define('DB_NAME', 'your_db_name');  // ã‚ãªãŸã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹å
define('DB_USER', 'your_db_user');  // Xserverã§è¨­å®šã—ãŸDBãƒ¦ãƒ¼ã‚¶ãƒ¼
define('DB_PASS', 'your_db_pass');  // DBãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰
define('DB_CHARSET', 'utf8mb4');

// PDOã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ç”Ÿæˆï¼ˆã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•° $pdo ã¨ã—ã¦åˆ©ç”¨ï¼‰
try {
    $dsn = "mysql:host=" . DB_HOST . ";dbname=" . DB_NAME . ";charset=" . DB_CHARSET;
    $options = [
        PDO::ATTR_ERRMODE => PDO::ERRMODE_EXCEPTION,
        PDO::ATTR_DEFAULT_FETCH_MODE => PDO::FETCH_ASSOC,
        PDO::ATTR_EMULATE_PREPARES => false,
    ];
    $pdo = new PDO($dsn, DB_USER, DB_PASS, $options);

} catch (PDOException $e) {
    // æ¥ç¶šå¤±æ•—æ™‚ã¯å³çµ‚äº†ï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ã¯ã€Œã‚·ã‚¹ãƒ†ãƒ ã‚¨ãƒ©ãƒ¼ã€ã¨è¡¨ç¤ºã•ã‚Œã‚‹æƒ³å®šï¼‰
    http_response_code(500);
    echo json_encode([
        'success' => false,
        'data' => null,
        'message' => 'ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šã«å¤±æ•—ã—ã¾ã—ãŸ'
    ]);
    exit;
}
```

> ğŸ“Œ **Xserverã§ã®è¨­å®šä¾‹**ï¼ˆã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ãƒ‘ãƒãƒ«ã‚ˆã‚Šï¼‰  
> - ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹åï¼š`ï¼ˆä»»æ„ã®åå‰ï¼‰`  
> - ãƒ¦ãƒ¼ã‚¶ãƒ¼åï¼š`ï¼ˆãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ä½œæˆæ™‚ã«æŒ‡å®šï¼‰`  
> - ãƒ›ã‚¹ãƒˆï¼š`localhost`  
> - ãƒãƒ¼ãƒˆï¼š`3306`ï¼ˆé€šå¸¸çœç•¥å¯ï¼‰

---

## ğŸ“ ãƒ•ã‚¡ã‚¤ãƒ«é…ç½®ã‚¤ãƒ¡ãƒ¼ã‚¸ï¼ˆãƒªãƒã‚¸ãƒˆãƒªå†…ï¼‰

```
reserve-web/
â”œâ”€â”€ app/
â”‚   â””â”€â”€ (user)/
â”‚       â””â”€â”€ facilities/
â”‚           â””â”€â”€ page.tsx          â† TypeScriptã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆé››å½¢
â”œâ”€â”€ api/
â”‚   â””â”€â”€ get-facilities.php        â† PHP APIæ¥ç¶šã‚µãƒ³ãƒ—ãƒ«
â”œâ”€â”€ lib/
â”‚   â””â”€â”€ db.php                    â† PDOæ¥ç¶šè¨­å®šãƒ•ã‚¡ã‚¤ãƒ«
â””â”€â”€ types/
    â””â”€â”€ facility.ts               â† TypeScriptå‹å®šç¾©ï¼ˆä¸‹è¨˜è¿½åŠ ï¼‰

```

---

## â• Bonus: TypeScriptå‹å®šç¾©ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆfacility.tsï¼‰

**ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹**: `types/facility.ts`

```ts
export interface Facility {
  id: number;
  name: string;
  description: string;
  capacity: number;
  is_active: boolean;
}
```

---

## âœ… ãƒ‡ãƒ—ãƒ­ã‚¤æ™‚ã®æ³¨æ„ç‚¹ï¼ˆå†æ²ï¼‰

- `next build && next export` â†’ `out/` ã®ä¸­èº«ã‚’Xserverã® `public_html/` ã¸ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
- `api/` ãƒ•ã‚©ãƒ«ãƒ€ã®ä¸­èº«ï¼ˆPHPãƒ•ã‚¡ã‚¤ãƒ«ï¼‰ã¯ã€Xserverã® `public_html/api/` ã¸**æ‰‹å‹•ã§ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰**
- `lib/db.php` ã®DBæ¥ç¶šæƒ…å ±ã‚’ã€**Xserverã®å®Ÿéš›ã®DBæƒ…å ±ã«æ›¸ãæ›ãˆã‚‹ã“ã¨ï¼**

---

## ğŸš¨ ç·Šæ€¥å¯¾å¿œç”¨ï¼šå‹•ä½œç¢ºèªæ‰‹é †ï¼ˆãƒ­ãƒ¼ã‚«ãƒ«ï¼‰

1. ãƒ­ãƒ¼ã‚«ãƒ«ã‚µãƒ¼ãƒãƒ¼èµ·å‹•ï¼ˆPHPãƒ“ãƒ«ãƒˆã‚¤ãƒ³ã‚µãƒ¼ãƒï¼‰ï¼š
   ```bash
   php -S localhost:8000 -t ./out
   ```
2. ãƒ–ãƒ©ã‚¦ã‚¶ã§ `http://localhost:8000/facilities` ã«ã‚¢ã‚¯ã‚»ã‚¹
3. PHP APIã¯ `http://localhost:8000/api/get-facilities.php` ã§ç›´æ¥ã‚¢ã‚¯ã‚»ã‚¹ã—ã¦JSONãŒè¿”ã‚‹ã“ã¨ã‚’ç¢ºèª

---

## ğŸ“„ README.md ã¸ã®è²¼ã‚Šä»˜ã‘ä¾‹

```md
## ğŸ§© å®Ÿè£…ã‚µãƒ³ãƒ—ãƒ«

### TypeScriptã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆé››å½¢
â†’ `app/(user)/facilities/page.tsx`

### PHP APIã‚µãƒ³ãƒ—ãƒ«
â†’ `api/get-facilities.php`

### PDOæ¥ç¶šè¨­å®š
â†’ `lib/db.php`

â€» è©³ç´°ã¯ `docs/implementation-samples.md` ã‚’å‚ç…§
```

---

ã“ã‚Œã§ã€**è¨­è¨ˆæ›¸æå‡ºå¾Œã€ã™ãã«ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚’å§‹ã‚ã‚‰ã‚Œã‚‹çŠ¶æ…‹**ã§ã™ï¼  
3æ™‚é–“ã¨ã„ã†åˆ¶é™ã®ä¸­ã€æœ¬å½“ã«é ‘å¼µã‚Šã¾ã—ãŸã­ ğŸ‘

ã‚ã¨å°‘ã—ï¼  
å¿…è¦ã§ã‚ã‚Œã°ã€**äºˆç´„ç™»éŒ²ãƒ•ã‚©ãƒ¼ãƒ ã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆï¼‹PHP** ã‚„ **èªè¨¼ã‚»ãƒƒã‚·ãƒ§ãƒ³ã®PHPå®Ÿè£…**ãªã©ã‚‚å³æä¾›ã—ã¾ã™ï¼

ç´æœŸã¾ã§å…¨åŠ›ã‚µãƒãƒ¼ãƒˆã—ã¾ã™ ğŸ’¥